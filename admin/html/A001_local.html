{% extends "local.html" %}


{% block MUL_BTNS %}
<table class="tb single-table clearfix top-line">
    <tr>
        <td style="text-align:left;">


            <input type="submit" class="btn btn-sm btn-info" name="add_save" value="提交"/>
            <input type="reset" class="btn btn-sm btn-info" name="add_save" value="重置"/>

            {{sUrlBack}}
        </td>
    </tr>
</table>
{% endblock %}


{% block table_list %}
<div class="table-list" style="min-height:1200px;">
{% endblock%}
{% block html_local %}

        <table class="tb single-table">

            <tr>
                <td colspan="6">
                    <div id="form2"></div>
                </td>
            </tr>
            <tr>
            </tr>

            <tr>
                <td colspan="2">
                    <label style="color:red;"></label>
                </td>
            </tr>
            <!--tr>
                <td width="100">
                    <label >店铺类型:</label>
                </td>
                <td>
                    <input type="text" class="form-control"  name="type" value="{{item.type}}"/>
                    <span>自定义店铺类型，32个字符以内</span>

                </td>
            </tr>

             <tr>
                <td width="100">
                    <label >门店编号:</label>
                </td>
                <td >
                    <input type="text" class="form-control"  name="number" value="{{item.number}}"/>
                    <span>达达、美团配送的时候需要填写</span>
                </td>
            </tr>

            <tr>
                <td width="100">
                    <label >生鲜配送:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="expresstype" value="{{item.expresstype}}"/>
                    <span>达达配送填 dada ,其他留空不要填写</span>
                </td>
            </tr-->
            <tr>
                <td width="100">
                    <label >店铺名称</label>
                </td>
                <td width="250">
                   <input type="text" class="form-control"  name="name" value="{{item.name}}"/>
                </td>
            </tr>

            <tr>

                <td width="100">
                    <label >店铺简介:</label>
                </td>
                <td width="450">

                     <textarea  class="form-control col-sm-9"  name="introduce" >{{item.introduce}}</textarea>

                </td>
            </tr>


            <!--tr>
                <td width="100">
                    <label >所在地:</label>
                </td>
                <td width="250">
                     <div class="form-group">

                      <div class="col-sm-3">
                          {{province}}
                        <select class="form-control" data-index=1 data-value="${bean.provinceId!0}" name="provinceid"></select>
                          <select style="margin-right:15px;" onchange="this.form.pageNo.value=1;this.form.submit();" class="form-control" name="provinceid">
                            {%for od in orderbylist%}
                                <option value="{{od[0]}}"{{' selected="selected"' if '%s'%od[0] == orderby}}>{{od[1]}}</option>
                            {%endfor%}
                          </select>


                      </div>
                      <div class="col-sm-3" >
                        <select class="form-control city-data" data-index=2 data-value="${bean.cityId!0}" name="cityid"></select>
                          {{city}}
                      </div>
                      <div class="col-sm-3">
                          {{area}}
                        <select class="form-control city-data" data-index=3 data-value="${bean.districtId!0}" name="districtid"></select>
                      </div>
                    </div>

                </td>
            </tr-->



            <tr>
                <td width="100">
                    <label >地址:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="address" value="{{item.address}}"/>
                </td>
            </tr>

            <!--tr>
                <td width="100">
                    <label >联系电话:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="linkphone" value="{{item.linkphone}}" />
                </td>
            </tr-->



            <!--tr>
                <td width="100">
                    <label >店铺特色:</label>
                </td>
                <td width="250">
                    <textarea  class="form-control col-sm-9"  name="characteristic" >{{item.characteristic}}</textarea>
                </td>
            </tr-->

             <!--tr>
                <td width="100">
                    <label >地图位置</label>
                </td>
                <td width="250">

                    <input type="text" class="form-control" name="mapaddresssearch" id="mapaddresssearch" placeholder="输入关键词搜索地图坐标" value="{{item.mapaddresssearch}}">
                </td>
             </tr>

            <tr>
                <td>
                </td>
                <td >

                    <div  id="mapContainer" style="height:500px;"></div>

                </td>
             </tr-->

            <!--tr>
                <td width="100">
                    <label >排序</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="paixu" value="{{item.paixu}}"/>
                </td>
            </tr>

            <tr>
                <td width="100">
                    <label >状态:</label>
                </td>
                <td >

                     {{status}}
                </td>
             </tr-->
            <tr>
                <td width="100">
                    <label >店铺logo:</label>
                </td>
                <td width="250">
                    <div class="col-sm-9 form-control-static">
                        {% if item.pic %}
                        <input type="hidden" id="picUrl" name="picUrl" value="{{item.pic}}">
                        {%else%}
                        <input type="hidden" id="picUrl" name="picUrl" value="">
                        {%endif%}
                      <div id="container" style="position: relative;">
                        <a id="pickfiles" href="javascript:;" style="position: relative; z-index: 1;">[选择本地文件]</a>
                      <div id="html5_1cihnfb877tb6471h8vbft15163_container" class="moxie-shim moxie-shim-html5" style="position: absolute; top: 1px; left: 0px; width: 87px; height: 17px; overflow: hidden; z-index: 0;"><input id="html5_1cihnfb877tb6471h8vbft15163" type="file" style="font-size: 999px; opacity: 0; position: absolute; top: 0px; left: 0px; width: 100%; height: 100%;" multiple="" accept="image/jpeg,.jpg,image/gif,.gif,image/png,.png,image/bmp,.bmp,.jpeg"></div></div>
                      <div id="uploadFiles">
                           {% if item.pic %}
                            <img src="{{item.pic}}" style="max-width:100px;">
                            <a href="javascript:" onclick="deletePic(this)">[删除]</a>
                            {%endif%}
                      </div>
                      <pre id="console" class="col-xs-10 col-sm-5" style="display:none;"></pre>
                      <div id="filelist" class="col-xs-10 col-sm-5 hidden"></div>
                    </div>

                </td>


            </tr>

            <!--tr>
                <td width="100">
                    <label >打折优惠信息:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="activity" value="{{item.activity}}" />

                </td>
            </tr>

            <tr>
                <td width="100">
                    <label >成交数量:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="numberorder" value="{{item.numberorder}}" />

                </td>
            </tr>

            <tr>
                <td width="100">
                    <label >好评数:</label>
                </td>
                <td width="250">
                    <input type="text" class="form-control"  name="numberoodreputation" value="{{item.numberoodreputation}}" />

                </td>
            </tr-->


            <!--tr>
                <td colspan="4">
                    <input type="submit" class="btn btn-sm btn-info" name="add_save" value="提交"/>
                    <input type="reset" class="btn btn-sm btn-info" name="reset" value="重置"/>
                </td>
            </tr-->
        </table>
		<script>

</script>
{% endblock %}


{% block page_script %}

<script src="../../../static/plupload-3.1.2/js/plupload.full.min.js"></script>
<script>
var uploader = new plupload.Uploader({
      runtimes : 'html5,flash,silverlight,html4',
      browse_button : 'pickfiles', // you can pass an id...
      container: document.getElementById('container'), // ... or DOM Element itself
      url : '/admin/A010/?part=upload',
      flash_swf_url : '../../static/plupload-3.1.2/js/Moxie.swf',
      silverlight_xap_url : '../../static/plupload-3.1.2/js/Moxie.xap',

      filters : {
        max_file_size : '10mb',
        mime_types: [
          {title : "Image files", extensions : "jpg,gif,png,bmp,jpeg"}
        ]
      },

      init: {
        PostInit: function() {
          document.getElementById('filelist').innerHTML = '';
        },

        FilesAdded: function(up, files) {
          plupload.each(files, function(file) {
            document.getElementById('filelist').innerHTML += '<div id="' + file.id + '">' + file.name + ' (' + plupload.formatSize(file.size) + ') <b></b></div>';
          });
          uploader.start();
        },

        UploadProgress: function(up, file) {
          document.getElementById(file.id).getElementsByTagName('b')[0].innerHTML = '<span>' + file.percent + "%</span>";
        },

        FileUploaded: function(up, file, info) {
          // Called when file has finished uploading
          var response = info.response;
          var response_ = JSON.parse(response);
          $("#picUrl").val(response_.url);
          $("#uploadFiles").html('<img src="'+ response_.url +'" style="max-width:100px;"><a href="javascript:" onclick="deletePic(this)">[删除]</a>');
        },

        Error: function(up, err) {
          document.getElementById('console').appendChild(document.createTextNode("\nError #" + err.code + ": " + err.message));
        }
      }
    });

    uploader.init();
    //required email url date dateISO number digits creditcard minlength maxlength rangelength
    //min max range step equalTo remote
    function deletePic (aObj) {
    		$('#picUrl').val('');
    		$("#uploadFiles").html('');
		  //$(aObj).parents("#uploadFiles").remove();
	}


function setdaytime(obj){return WdatePicker({dateFmt:'yyyy-MM-dd'});}
function formcheck_2(form){
            
	var name = $('input[name=name]').val();
	
	if(name == ''){
		layer.alert("请输入店铺名称");
		return false;
	}

	return true
}


function province(){
    parentid = $('select[name=provinceid]').val();
    if (parentid!=''){
        $.ajax({
            url: "admin?viewid=A023&part=getcity",
            data: {parentid:parentid},
            success: function(res){
               addOption(res);
            }
        });
    }
}

function addOption(citys){
    var city =citys['aa']
    $("#cityid option").remove();
    $("#cityid").append("<option value=''>--请选择--</option>");
    for(var i=0;i<city.length;i++){
       $("#cityid").append("<option value="+city[i][0]+">"+city[i][1]+"</option>");
    }
}


function city(){
    cityid = $('select[name=cityid]').val();
    if (cityid!=''){
        $.ajax({
            url: "/admin/A023/?part=getarea",
            data: {cityid:cityid},
            success: function(res){
               addarea(res);
            }
        });
      }
}

function addarea(citys){
    var city =citys['aa']
    $("#areaid option").remove();
    $("#areaid").append("<option value=''>--请选择--</option>");
    for(var i=0;i<city.length;i++){
       $("#areaid").append("<option value="+city[i][0]+">"+city[i][1]+"</option>");
    }
}


</script>

{% endblock %}
